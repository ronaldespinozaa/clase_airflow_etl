<?xml version="1.0" encoding="UTF-8"?>
<svg viewBox="0 0 900 600" xmlns="http://www.w3.org/2000/svg">
  <!-- Fondo y título -->
  <rect width="900" height="600" fill="#f8f9fa" />
  <text x="450" y="50" font-family="Arial" font-size="24" font-weight="bold" text-anchor="middle" fill="#017cee">Arquitectura de Apache Airflow</text>
  
  <!-- Contenedor Docker -->
  <rect x="50" y="80" width="800" height="480" rx="10" ry="10" fill="#e6f2ff" stroke="#0056b3" stroke-width="2" stroke-dasharray="5,5" />
  <text x="450" y="105" font-family="Arial" font-size="18" font-weight="bold" text-anchor="middle" fill="#0056b3">Entorno Docker</text>

  <!-- Servicio PostgreSQL -->
  <rect x="100" y="250" width="200" height="130" rx="5" ry="5" fill="#ffecb3" stroke="#e6a700" stroke-width="2" />
  <text x="200" y="275" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle" fill="#664d00">PostgreSQL</text>
  <rect x="120" y="290" width="160" height="30" rx="3" ry="3" fill="#fff8e1" stroke="#e6a700" stroke-width="1" />
  <text x="200" y="310" font-family="Arial" font-size="12" text-anchor="middle" fill="#664d00">Airflow Metadata</text>
  <rect x="120" y="330" width="160" height="30" rx="3" ry="3" fill="#fff8e1" stroke="#e6a700" stroke-width="1" />
  <text x="200" y="350" font-family="Arial" font-size="12" text-anchor="middle" fill="#664d00">ETL Data</text>

  <!-- Servicios de Airflow -->
  <rect x="350" y="140" width="400" height="350" rx="5" ry="5" fill="#d1e7dd" stroke="#198754" stroke-width="2" />
  <text x="550" y="165" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle" fill="#0f5132">Apache Airflow</text>
  
  <!-- Webserver -->
  <rect x="380" y="190" width="150" height="80" rx="5" ry="5" fill="#ffffff" stroke="#198754" stroke-width="2" />
  <text x="455" y="215" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#0f5132">Webserver</text>
  <text x="455" y="235" font-family="Arial" font-size="12" text-anchor="middle" fill="#0f5132">Interfaz de usuario</text>
  <text x="455" y="255" font-family="Arial" font-size="12" text-anchor="middle" fill="#0f5132">Puerto 8080</text>
  
  <!-- Scheduler -->
  <rect x="570" y="190" width="150" height="80" rx="5" ry="5" fill="#ffffff" stroke="#198754" stroke-width="2" />
  <text x="645" y="215" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#0f5132">Scheduler</text>
  <text x="645" y="235" font-family="Arial" font-size="12" text-anchor="middle" fill="#0f5132">Programa ejecución</text>
  <text x="645" y="255" font-family="Arial" font-size="12" text-anchor="middle" fill="#0f5132">de tareas</text>
  
  <!-- DAGs -->
  <rect x="380" y="310" width="340" height="150" rx="5" ry="5" fill="#ffffff" stroke="#198754" stroke-width="2" />
  <text x="550" y="335" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#0f5132">DAGs (Directed Acyclic Graphs)</text>
  
  <!-- ETL DAG -->
  <rect x="400" y="350" width="140" height="90" rx="5" ry="5" fill="#e2f0fc" stroke="#0d6efd" stroke-width="1" />
  <text x="470" y="370" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle" fill="#0d6efd">ETL DAG</text>
  <rect x="410" y="380" width="120" height="15" rx="3" ry="3" fill="#ffffff" stroke="#0d6efd" stroke-width="1" />
  <text x="470" y="392" font-family="Arial" font-size="9" text-anchor="middle" fill="#0d6efd">Extract</text>
  <rect x="410" y="400" width="120" height="15" rx="3" ry="3" fill="#ffffff" stroke="#0d6efd" stroke-width="1" />
  <text x="470" y="412" font-family="Arial" font-size="9" text-anchor="middle" fill="#0d6efd">Transform</text>
  <rect x="410" y="420" width="120" height="15" rx="3" ry="3" fill="#ffffff" stroke="#0d6efd" stroke-width="1" />
  <text x="470" y="432" font-family="Arial" font-size="9" text-anchor="middle" fill="#0d6efd">Load</text>
  
  <!-- Export DAG -->
  <rect x="560" y="350" width="140" height="90" rx="5" ry="5" fill="#f8d7da" stroke="#dc3545" stroke-width="1" />
  <text x="630" y="370" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle" fill="#842029">Export DAG</text>
  <rect x="570" y="380" width="120" height="15" rx="3" ry="3" fill="#ffffff" stroke="#dc3545" stroke-width="1" />
  <text x="630" y="392" font-family="Arial" font-size="9" text-anchor="middle" fill="#842029">Export Data</text>
  <rect x="570" y="400" width="120" height="15" rx="3" ry="3" fill="#ffffff" stroke="#dc3545" stroke-width="1" />
  <text x="630" y="412" font-family="Arial" font-size="9" text-anchor="middle" fill="#842029">Generate Report</text>
  <rect x="570" y="420" width="120" height="15" rx="3" ry="3" fill="#ffffff" stroke="#dc3545" stroke-width="1" />
  <text x="630" y="432" font-family="Arial" font-size="9" text-anchor="middle" fill="#842029">Notify</text>

  <!-- API -->
  <rect x="100" y="140" width="170" height="70" rx="5" ry="5" fill="#f8edeb" stroke="#e35d6a" stroke-width="2" />
  <text x="185" y="170" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#c9184a">API de datos</text>
  <text x="185" y="190" font-family="Arial" font-size="12" text-anchor="middle" fill="#c9184a">OpenWeatherMap</text>

  <!-- Volúmenes para exportación -->
  <rect x="100" y="420" width="170" height="70" rx="5" ry="5" fill="#e7f5ff" stroke="#1c7ed6" stroke-width="2" />
  <text x="185" y="450" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#1971c2">Volumen de datos</text>
  <text x="185" y="470" font-family="Arial" font-size="12" text-anchor="middle" fill="#1971c2">Datos exportados</text>

  <!-- Líneas de conexión -->
  <!-- API a ETL -->
  <line x1="270" y1="175" x2="380" y2="385" stroke="#c9184a" stroke-width="2" stroke-dasharray="5,5" />
  <polygon points="380,385 370,377 373,387" fill="#c9184a" />
  
  <!-- ETL a PostgreSQL -->
  <line x1="400" y1="425" x2="300" y2="330" stroke="#0d6efd" stroke-width="2" />
  <polygon points="300,330 302,342 310,335" fill="#0d6efd" />
  
  <!-- Scheduler a DAG -->
  <line x1="645" y1="270" x2="600" y2="310" stroke="#198754" stroke-width="2" />
  <polygon points="600,310 605,300 610,307" fill="#198754" />
  
  <!-- PostgreSQL a Airflow Metadata -->
  <line x1="300" y1="250" x2="350" y2="200" stroke="#e6a700" stroke-width="2" />
  <polygon points="350,200 340,205 345,210" fill="#e6a700" />
  
  <!-- Export a Volumen -->
  <line x1="560" y1="410" x2="270" y2="455" stroke="#dc3545" stroke-width="2" />
  <polygon points="270,455 280,450 282,460" fill="#dc3545" />

  <!-- Leyendas -->
  <rect x="680" y="510" width="20" height="10" fill="#ffecb3" stroke="#e6a700" stroke-width="1" />
  <text x="705" y="518" font-family="Arial" font-size="12" fill="#333">Almacenamiento</text>
  
  <rect x="680" y="530" width="20" height="10" fill="#d1e7dd" stroke="#198754" stroke-width="1" />
  <text x="705" y="538" font-family="Arial" font-size="12" fill="#333">Componentes Airflow</text>
  
  <rect x="680" y="550" width="20" height="10" fill="#f8edeb" stroke="#e35d6a" stroke-width="1" />
  <text x="705" y="558" font-family="Arial" font-size="12" fill="#333">Fuentes de datos</text>
  
  <!-- Usuario -->
  <g transform="translate(550, 60)">
    <!-- Cabeza -->
    <circle cx="0" cy="0" r="10" fill="#6c757d" />
    <!-- Cuerpo -->
    <line x1="0" y1="10" x2="0" y2="30" stroke="#6c757d" stroke-width="2" />
    <!-- Brazos -->
    <line x1="-10" y1="20" x2="10" y2="20" stroke="#6c757d" stroke-width="2" />
    <!-- Piernas -->
    <line x1="0" y1="30" x2="-7" y2="45" stroke="#6c757d" stroke-width="2" />
    <line x1="0" y1="30" x2="7" y2="45" stroke="#6c757d" stroke-width="2" />
  </g>
  
  <!-- Línea de usuario a Webserver -->
  <line x1="550" y1="100" x2="470" y2="190" stroke="#6c757d" stroke-width="2" stroke-dasharray="5,3" />
  <polygon points="470,190 475,180 480,188" fill="#6c757d" />
  <text x="520" y="130" font-family="Arial" font-size="12" fill="#6c757d">HTTP</text>

  <!-- Etiqueta docker-compose -->
  <text x="100" y="105" font-family="Arial" font-size="14" fill="#0056b3">docker-compose.yml</text>
</svg>